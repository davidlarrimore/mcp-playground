version: "3.9"

networks:
  mcp-net:
    driver: bridge

volumes:
  memory-data:

services:
  mailhog:
    image: mailhog/mailhog:latest
    container_name: mailhog
    restart: unless-stopped
    networks:
      - mcp-net
    ports:
      - "${MAILHOG_WEB_PORT:-2005}:8025"
      - "${MAILHOG_SMTP_PORT:-2025}:1025"
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  time-mcp:
    build:
      context: ./time-bridge
    container_name: time-mcp
    restart: unless-stopped
    networks:
      - mcp-net
    ports:
      - "${TIME_MCP_PORT:-2001}:8000"
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  filesystem-mcp:
    build:
      context: ./filesystem-bridge
    container_name: filesystem-mcp
    restart: unless-stopped
    networks:
      - mcp-net
    ports:
      - "${FILESYSTEM_MCP_PORT:-2002}:8000"
    environment:
      FILESYSTEM_ROOT: ${FILESYSTEM_ROOT:-/docs}
      FS_BASE_DIRECTORY: ${FILESYSTEM_ROOT:-/docs}
    volumes:
      - ./docs:${FILESYSTEM_ROOT:-/docs}:rw
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  memory-mcp:
    build:
      context: ./memory-bridge
    container_name: memory-mcp
    restart: unless-stopped
    networks:
      - mcp-net
    ports:
      - "${MEMORY_MCP_PORT:-2003}:8000"
    environment:
      MEMORY_FILE_PATH: /data/memory.json
    volumes:
      - memory-data:/data
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  mcpo:
    image: ghcr.io/open-webui/mcpo:main
    container_name: mcpo
    restart: unless-stopped
    networks:
      - mcp-net
    ports:
      - "${MCPO_PORT:-2010}:8000"
    command: ["--config", "/app/config.json", "--port", "8000"]
    volumes:
      - ./mcpo-config.json:/app/config.json:ro
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  email-mcp:
    build:
      context: ./email-mcp
    container_name: email-mcp
    restart: unless-stopped
    networks:
      - mcp-net
    ports:
      - "${EMAIL_MCP_PORT:-2004}:8000"
    environment:
      SMTP_HOST: ${SMTP_HOST:-mailhog}
      SMTP_PORT: ${SMTP_PORT:-1025}
      SMTP_FROM_DEFAULT: ${SMTP_FROM_DEFAULT:-noreply@example.test}
      ATTACH_ROOT: ${ATTACH_ROOT:-/attachments}
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
    volumes:
      - ./docs:${ATTACH_ROOT:-/attachments}:ro
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  excel-mcp:
    build:
      context: ./excel-mcp
    container_name: excel-mcp
    restart: unless-stopped
    networks:
      - mcp-net
    ports:
      - "${EXCEL_MCP_PORT:-2006}:8000"
    environment:
      WORKSPACE: /workspace
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
    volumes:
      - ./docs:/workspace:rw
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  word-mcp:
    build:
      context: ./word-mcp
    container_name: word-mcp
    restart: unless-stopped
    networks:
      - mcp-net
    ports:
      - "${WORD_MCP_PORT:-2007}:8000"
    environment:
      WORKSPACE: /workspace
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
    volumes:
      - ./docs:/workspace:rw
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  pdf-mcp:
    build:
      context: ./pdf-mcp
    container_name: pdf-mcp
    restart: unless-stopped
    networks:
      - mcp-net
    ports:
      - "${PDF_MCP_PORT:-2008}:8000"
    environment:
      WORKSPACE: /workspace
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
    volumes:
      - ./docs:/workspace:rw
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  analytics-mcp:
    build:
      context: ./analytics-mcp
    container_name: analytics-mcp
    restart: unless-stopped
    networks:
      - mcp-net
    ports:
      - "${ANALYTICS_MCP_PORT:-2009}:8000"
    environment:
      WORKSPACE: /workspace
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
    volumes:
      - ./docs:/workspace:rw
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
